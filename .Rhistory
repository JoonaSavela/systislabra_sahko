setwd("/m/home/home1/10/savelaj3/data/Documents/R/systislabra_sahko")
source('/m/home/home1/10/savelaj3/data/Documents/R/systislabra_sahko/pohja.r', echo=TRUE)
par(mfrow=c(2,2))
acf(dele, lag.max=168)
acf(dele, lag.max=168, type = "partial")
acf(dtemp, lag.max=168)
acf(dtemp, lag.max=168, type = "partial")
par(mfrow=c(1,1))
ccf(dele, dtemp, lag.max=168)
Box.test(malli2$residuals,
lag = 20,
type = "Ljung-Box",
fitdf = p + q + P + Q)
ts.plot(malli$residuals)
hist(malli$residuals)
ts.plot(malli2$residuals)
hist(malli2$residuals)
hist(malli$residuals)
par(mfrow=c(1,1))
ts.plot(ele,
ele - malli2$residuals,
enne2$pred,
enne2$pred + 1.96*enne2$se,
enne2$pred - 1.96*enne2$se,
col = c("black", "red", "blue", "blue", "blue"),
main  = "Sovite ja ennuste")
ts.plot(enne$pred,
enne$pred + 1.96*enne$se,
enne$pred - 1.96*enne$se,
col = c("black", "blue", "blue"),
main = "Ennuste ja  95 %:n luottamusv?lit")
ts.plot(enne2$pred,
enne2$pred + 1.96*enne2$se,
enne2$pred - 1.96*enne2$se,
col = c("black", "blue", "blue"),
main = "Ennuste ja  95 %:n luottamusv?lit")
par(mfrow=c(2,2))
acf(ele, lag.max=168)
acf(ele, lag.max=168, type = "partial")
acf(temp, lag.max=168)
acf(temp, lag.max=168, type = "partial")
par(mfrow=c(1,1))
ccf(ele,temp, lag.max=168)
d = 0 # Differoinnin kertaluku d
S = 24 # Kausidifferoinnin jakso S
D = 1 # Kausidifferensoinnin kertaluku D
dele = ele
dtemp = temp
if (d > 0) {
dele = diff(dele, lag = 1, differences = d)
dtemp = diff(dtemp, lag = 1, differences = d)
}
if (D > 0) {
dele = diff(dele, lag = S, differences = D)
dtemp = diff(dtemp, lag = S, differences = D)
}
par(mfrow=c(2,2))
acf(dele, lag.max=168)
acf(dele, lag.max=168, type = "partial")
acf(dtemp, lag.max=168)
acf(dtemp, lag.max=168, type = "partial")
d = 1 # Differoinnin kertaluku d
S = 24 # Kausidifferoinnin jakso S
D = 0 # Kausidifferensoinnin kertaluku D
dele = ele
dtemp = temp
if (d > 0) {
dele = diff(dele, lag = 1, differences = d)
dtemp = diff(dtemp, lag = 1, differences = d)
}
if (D > 0) {
dele = diff(dele, lag = S, differences = D)
dtemp = diff(dtemp, lag = S, differences = D)
}
par(mfrow=c(2,2))
acf(dele, lag.max=168)
acf(dele, lag.max=168, type = "partial")
acf(dtemp, lag.max=168)
acf(dtemp, lag.max=168, type = "partial")
par(mfrow=c(1,1))
ccf(dele, dtemp, lag.max=168)
malli = arima(ele,
order = c(p,d,q),
seasonal = list(order = c(P, D, Q),period = S),
method = "CSS")
enne = predict(malli, n.ahead = 24)
L = 12
tempestimointi = eletemp$Celcius[1:(816-L)]
tempennuste = eletemp$Celcius[(816-L+1):(816-L+24)]
eleestimointi = ts(eletemp$kWh[(1+L):816], start = 1, frequency = 24)
malli2 = arima(eleestimointi,
order = c(p,d,q),
seasonal = list(order = c(P, D, Q), period = S),
xreg = tempestimointi,
method = "CSS")
enne2 = predict(malli2,
n.ahead = 24,
newxreg = tempennuste)
Box.test(malli2$residuals,
lag = 20,
type = "Ljung-Box",
fitdf = p + q + P + Q)
Box.test(malli$residuals,
lag = 20,
type = "Ljung-Box",
fitdf = p + q + P + Q)
par(mfrow=c(1,1))
ts.plot(ele,
ele - malli2$residuals,
enne2$pred,
enne2$pred + 1.96*enne2$se,
enne2$pred - 1.96*enne2$se,
col = c("black", "red", "blue", "blue", "blue"),
main  = "Sovite ja ennuste")
ts.plot(enne2$pred,
enne2$pred + 1.96*enne2$se,
enne2$pred - 1.96*enne2$se,
col = c("black", "blue", "blue"),
main = "Ennuste ja  95 %:n luottamusv?lit")
ts.plot(ele,
ele - malli$residuals,
enne$pred,
enne$pred + 1.96*enne$se,
enne$pred - 1.96*enne$se,
col = c("black", "red", "blue", "blue", "blue"),
main  = "Sovite ja ennuste")
ts.plot(enne$pred,
enne$pred + 1.96*enne$se,
enne$pred - 1.96*enne$se,
col = c("black", "blue", "blue"),
main = "Ennuste ja  95 %:n luottamusv?lit")
ts.plot(enne2$pred,
enne2$pred + 1.96*enne2$se,
enne2$pred - 1.96*enne2$se,
col = c("black", "blue", "blue"),
main = "Ennuste ja  95 %:n luottamusv?lit")
p = 2
q = 2
P = 2
Q = 2
malli = arima(ele,
order = c(p,d,q),
seasonal = list(order = c(P, D, Q),period = S),
method = "CSS")
enne = predict(malli, n.ahead = 24)
L = 12
tempestimointi = eletemp$Celcius[1:(816-L)]
tempennuste = eletemp$Celcius[(816-L+1):(816-L+24)]
eleestimointi = ts(eletemp$kWh[(1+L):816], start = 1, frequency = 24)
malli2 = arima(eleestimointi,
order = c(p,d,q),
seasonal = list(order = c(P, D, Q), period = S),
xreg = tempestimointi,
method = "CSS")
enne2 = predict(malli2,
n.ahead = 24,
newxreg = tempennuste)
Box.test(malli$residuals,
lag = 20,
type = "Ljung-Box",
fitdf = p + q + P + Q)
Box.test(malli2$residuals,
lag = 20,
type = "Ljung-Box",
fitdf = p + q + P + Q)
ts.plot(ele,
ele - malli$residuals,
enne$pred,
enne$pred + 1.96*enne$se,
enne$pred - 1.96*enne$se,
col = c("black", "red", "blue", "blue", "blue"),
main  = "Sovite ja ennuste")
ts.plot(enne$pred,
enne$pred + 1.96*enne$se,
enne$pred - 1.96*enne$se,
col = c("black", "blue", "blue"),
main = "Ennuste ja  95 %:n luottamusv?lit")
ts.plot(ele,
ele - malli2$residuals,
enne2$pred,
enne2$pred + 1.96*enne2$se,
enne2$pred - 1.96*enne2$se,
col = c("black", "red", "blue", "blue", "blue"),
main  = "Sovite ja ennuste")
ts.plot(enne2$pred,
enne2$pred + 1.96*enne2$se,
enne2$pred - 1.96*enne2$se,
col = c("black", "blue", "blue"),
main = "Ennuste ja  95 %:n luottamusv?lit")
ts.plot(enne$pred,
enne$pred + 1.96*enne$se,
enne$pred - 1.96*enne$se,
col = c("black", "blue", "blue"),
main = "Ennuste ja  95 %:n luottamusv?lit")
source('/m/home/home1/10/savelaj3/data/Documents/R/systislabra_sahko/esimerkki.r', echo=TRUE)
source('/m/home/home1/10/savelaj3/data/Documents/R/systislabra_sahko/esimerkki.r', echo=TRUE)
ts.plot(ennuste, clyla, clala, col = c("black", "blue", "blue"))
source('/m/home/home1/10/savelaj3/data/Documents/R/systislabra_sahko/main.R', echo=TRUE)
par(mfrow=c(2,2))
acf(ele, lag.max=168)
acf(ele, lag.max=168, type = "partial")
acf(temp, lag.max=168)
acf(temp, lag.max=168, type = "partial")
par(mfrow=c(1,1))
ccf(ele,temp, lag.max=168)
dele168 <- diff(ele, lag = L1, differences = 1)
ts.plot(dele168,
xlab = "aika/vrk",
ylab = "kulutus/kWh")
par(mfrow=c(2,1))
acf(dele168, lag.max=168)
acf(dele168, lag.max=168, type = "partial")
dele168 <- diff(ele, lag = L1, differences = 1)
ts.plot(dele168,
xlab = "aika/vrk",
ylab = "kulutus/kWh")
par(mfrow=c(1,2))
acf(dele168, lag.max=168)
acf(dele168, lag.max=168, type = "partial")
par(mfrow=c(1,1))
ccf(ele,temp, lag.max=168)
ccf(dele168,temp, lag.max=168)
dele <- diff(dele168, lag = L2, differences = 1)
ts.plot(dele,
xlab = "aika/vrk",
ylab = "kulutus/kWh")
par(mfrow=c(1,2))
acf(dele, lag.max=168)
acf(dele, lag.max=168, type = "partial")
par(mfrow=c(1,1))
ccf(dele,temp, lag.max=168)
7*24
d = 1
S = L2
D = 1
